{"is_source_file": true, "format": "Python", "description": "This file provides utilities for ingesting JSON datasets into an SQLite database, including schema inference, data coercion, and file handling functions. It specifically loads deduplicated datasets into normalized tables, supports security considerations, and exposes a main function for batch processing JSON files from a data directory.", "external_files": ["from .database import get_db_connection"], "external_methods": [], "published": ["run_json_ingestion"], "classes": [], "methods": [{"name": "bool _is_iso_datetime(value: str)", "description": "Checks if a string string is in ISO 8601 datetime format.", "scope": "", "scopeKind": ""}, {"name": "str _normalize_identifier(name: str, max_len: int = 60)", "description": "Sanitizes and normalizes strings to be used as SQL identifiers.", "scope": "", "scopeKind": ""}, {"name": "str _infer_type(current: str, value: Any)", "description": "Infers SQLite data type based on current type and value.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,str] _union_schema(rows: Iterable[Mapping[str, Any]])", "description": "Creates a union schema from multiple rows by inferring column types.", "scope": "", "scopeKind": ""}, {"name": "Any _coerce_value(sql_type: str, value: Any)", "description": "Converts values to appropriate SQLite-compatible types based on column schema.", "scope": "", "scopeKind": ""}, {"name": "List[str] _latest_json_files(data_root: str)", "description": "Retrieves the latest JSON files from the specified data directory.", "scope": "", "scopeKind": ""}, {"name": "None _safe_execute(conn: sqlite3.Connection, sql: str)", "description": "Executes SQL commands safely.", "scope": "", "scopeKind": ""}, {"name": "None _ensure_table(conn: sqlite3.Connection, table: str, schema: Dict[str, str])", "description": "Creates a table if it doesn't exist and adds missing columns.", "scope": "", "scopeKind": ""}, {"name": "None _truncate_table(conn: sqlite3.Connection, table: str)", "description": "Removes all data from a table.", "scope": "", "scopeKind": ""}, {"name": "int _insert_rows(conn: sqlite3.Connection, table: str, schema: Dict[str, str], rows: Iterable[Mapping[str, Any]])", "description": "Inserts multiple rows into a table efficiently.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] run_json_ingestion(data_root: Optional[str] = None)", "description": "Main function to ingest JSON files into an SQLite database, handling schema inference, file processing, and error handling.", "scope": "", "scopeKind": ""}], "calls": ["get_db_connection", "_safe_execute", "_ensure_table", "_truncate_table", "_insert_rows", "json.load", "os.path.splitext", "os.path.basename", "os.path.isdir", "os.listdir", "os.path.getmtime", "datetime.fromisoformat"], "search-terms": ["json_loader", "JSON ingestion", "SQLite table creation", "schema inference", "deduplicated datasets", "load JSON into SQLite", "dataset normalization", "file processing", "security in data loading"], "state": 2, "file_id": 6, "knowledge_revision": 21, "git_revision": "065df23472e281fd09949ae2d564d9b7e195e4d7", "revision_history": [{"13": ""}, {"21": "065df23472e281fd09949ae2d564d9b7e195e4d7"}], "ctags": [{"_type": "tag", "name": "DATA_ROOT_DEFAULT", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^DATA_ROOT_DEFAULT = os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(os.path.dirname/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_coerce_value", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _coerce_value(sql_type: str, value: Any) -> Any:$/", "language": "Python", "typeref": "typename:Any", "kind": "function", "signature": "(sql_type: str, value: Any)"}, {"_type": "tag", "name": "_ensure_table", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _ensure_table(conn: sqlite3.Connection, table: str, schema: Dict[str, str]) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(conn: sqlite3.Connection, table: str, schema: Dict[str, str])"}, {"_type": "tag", "name": "_infer_type", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _infer_type(current: str, value: Any) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(current: str, value: Any)"}, {"_type": "tag", "name": "_insert_rows", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _insert_rows(conn: sqlite3.Connection, table: str, schema: Dict[str, str], rows: Iterable[Ma/", "language": "Python", "typeref": "typename:int", "kind": "function", "signature": "(conn: sqlite3.Connection, table: str, schema: Dict[str, str], rows: Iterable[Mapping[str, Any]])"}, {"_type": "tag", "name": "_is_iso_datetime", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _is_iso_datetime(value: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(value: str)"}, {"_type": "tag", "name": "_latest_json_files", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _latest_json_files(data_root: str) -> List[str]:$/", "language": "Python", "typeref": "typename:List[str]", "kind": "function", "signature": "(data_root: str)"}, {"_type": "tag", "name": "_normalize_identifier", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _normalize_identifier(name: str, max_len: int = 60) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(name: str, max_len: int = 60)"}, {"_type": "tag", "name": "_safe_execute", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _safe_execute(conn: sqlite3.Connection, sql: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(conn: sqlite3.Connection, sql: str)"}, {"_type": "tag", "name": "_truncate_table", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _truncate_table(conn: sqlite3.Connection, table: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(conn: sqlite3.Connection, table: str)"}, {"_type": "tag", "name": "_union_schema", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _union_schema(rows: Iterable[Mapping[str, Any]]) -> Dict[str, str]:$/", "language": "Python", "typeref": "typename:Dict[str,str]", "kind": "function", "signature": "(rows: Iterable[Mapping[str, Any]])"}, {"_type": "tag", "name": "run_json_ingestion", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def run_json_ingestion(data_root: Optional[str] = None) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(data_root: Optional[str] = None)"}], "hash": "f3db2d74991f94bd7de3b6345465cd00", "format-version": 4, "code-base-name": "career_platform_backend", "filename": "career_platform_backend/src/api/ingestion/json_loader.py", "fields": [{"name": "DATA_ROOT_DEFAULT = os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(os.path.dirname/", "scope": "", "scopeKind": "", "description": "unavailable"}]}