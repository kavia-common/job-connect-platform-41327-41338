{"is_source_file": true, "format": "Python", "description": "This is a Python source file that provides utilities for loading and processing JSON datasets into an SQLite database, including schema inference, data validation, and ingestion functions with modular design and comments.", "external_files": ["from .database import get_db_connection"], "external_methods": ["get_db_connection"], "published": ["run_json_ingestion"], "classes": [], "methods": [{"name": "bool _is_iso_datetime(value: str)", "description": "Checks if the given string is in a valid ISO 8601 datetime format.", "scope": "", "scopeKind": ""}, {"name": "str _normalize_identifier(name: str, max_len: int = 60)", "description": "Normalizes a string to snake_case suitable for database identifiers, with a maximum length.", "scope": "", "scopeKind": ""}, {"name": "str _infer_type(current: str, value: Any)", "description": "Infers the SQLite data type of a value based on its content.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,str] _union_schema(rows: Iterable[Mapping[str, Any]])", "description": "Creates a combined schema inferred from multiple data rows, merging field types.", "scope": "", "scopeKind": ""}, {"name": "Any _coerce_value(sql_type: str, value: Any)", "description": "Converts a Python value to its appropriate SQLite data representation based on schema type.", "scope": "", "scopeKind": ""}, {"name": "List[str] _latest_json_files(data_root: str)", "description": "Retrieves the list of latest modified JSON files from a specified directory.", "scope": "", "scopeKind": ""}, {"name": "None _safe_execute(conn: sqlite3.Connection, sql: str)", "description": "Executes a SQL statement safely within a database connection.", "scope": "", "scopeKind": ""}, {"name": "None _ensure_table(conn: sqlite3.Connection, table: str, schema: Dict[str, str])", "description": "Creates a table if it doesn't exist and adds missing columns based on the schema.", "scope": "", "scopeKind": ""}, {"name": "None _truncate_table(conn: sqlite3.Connection, table: str)", "description": "Deletes all data from the specified table.", "scope": "", "scopeKind": ""}, {"name": "int _insert_rows(conn: sqlite3.Connection, table: str, schema: Dict[str, str], rows: Iterable[Mapping[str, Any]])", "description": "Inserts multiple data rows into a database table efficiently.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] run_json_ingestion(data_root: Optional[str] = None)", "description": "Main function to scan JSON files in a directory and ingest them into SQLite, creating tables and inserting data as needed.", "scope": "", "scopeKind": ""}], "calls": ["get_db_connection", "json.load", "os.path.splitext", "os.path.basename", "os.environ.get", "os.listdir", "os.path.isdir", "os.path.isfile", "os.path.getmtime", "open", "datetime.fromisoformat", "re.sub"], "search-terms": ["json_loader", "ingestion", "schema inference", "SQLite table creation", "deduplicated datasets", "json dataset ingestion", "automatic schema inference", "file normalization"], "state": 2, "file_id": 6, "knowledge_revision": 13, "git_revision": "", "ctags": [{"_type": "tag", "name": "DATA_ROOT_DEFAULT", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^DATA_ROOT_DEFAULT = os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(os.path.dirname/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_coerce_value", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _coerce_value(sql_type: str, value: Any) -> Any:$/", "language": "Python", "typeref": "typename:Any", "kind": "function", "signature": "(sql_type: str, value: Any)"}, {"_type": "tag", "name": "_ensure_table", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _ensure_table(conn: sqlite3.Connection, table: str, schema: Dict[str, str]) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(conn: sqlite3.Connection, table: str, schema: Dict[str, str])"}, {"_type": "tag", "name": "_infer_type", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _infer_type(current: str, value: Any) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(current: str, value: Any)"}, {"_type": "tag", "name": "_insert_rows", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _insert_rows(conn: sqlite3.Connection, table: str, schema: Dict[str, str], rows: Iterable[Ma/", "language": "Python", "typeref": "typename:int", "kind": "function", "signature": "(conn: sqlite3.Connection, table: str, schema: Dict[str, str], rows: Iterable[Mapping[str, Any]])"}, {"_type": "tag", "name": "_is_iso_datetime", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _is_iso_datetime(value: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(value: str)"}, {"_type": "tag", "name": "_latest_json_files", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _latest_json_files(data_root: str) -> List[str]:$/", "language": "Python", "typeref": "typename:List[str]", "kind": "function", "signature": "(data_root: str)"}, {"_type": "tag", "name": "_normalize_identifier", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _normalize_identifier(name: str, max_len: int = 60) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(name: str, max_len: int = 60)"}, {"_type": "tag", "name": "_safe_execute", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _safe_execute(conn: sqlite3.Connection, sql: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(conn: sqlite3.Connection, sql: str)"}, {"_type": "tag", "name": "_truncate_table", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _truncate_table(conn: sqlite3.Connection, table: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(conn: sqlite3.Connection, table: str)"}, {"_type": "tag", "name": "_union_schema", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def _union_schema(rows: Iterable[Mapping[str, Any]]) -> Dict[str, str]:$/", "language": "Python", "typeref": "typename:Dict[str,str]", "kind": "function", "signature": "(rows: Iterable[Mapping[str, Any]])"}, {"_type": "tag", "name": "run_json_ingestion", "path": "/home/kavia/workspace/code-generation/job-connect-platform-41327-41338/career_platform_backend/src/api/ingestion/json_loader.py", "pattern": "/^def run_json_ingestion(data_root: Optional[str] = None) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(data_root: Optional[str] = None)"}], "hash": "d637d2a305ff16d0fc201cfcec886858", "format-version": 4, "code-base-name": "career_platform_backend", "filename": "career_platform_backend/src/api/ingestion/json_loader.py", "fields": [{"name": "DATA_ROOT_DEFAULT = os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(os.path.dirname/", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"13": ""}]}